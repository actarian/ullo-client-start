{"version":3,"sources":["wwwroot/js/app.js"],"names":["app","angular","module","config","$routeProvider","$locationProvider","when","controller","templateUrl","title","isForward","otherwise","html5Mode","$scope","$timeout","$http","$location","model","input2Options","name","id","get","then","response","data","error","console","log","signin","signinFormError","signinFormBusy","clicked","post","success","path","message","label","setTimeout","item","user","userName","facebookId","route","dish","price","isVeganFriendly","yes","no","created","vote","dishId","like","categories","key","picture","guid","loadStream","items","animation","$rootScope","$animate","isFirstView","currentRoute","isBackward","previousRoute","bezierOptions","type","dynamics","bezier","points","x","y","cp","duration","$on","event","current","previous","$$route","enter","element","done","css","translateY","opacity","scale","animate","w","offsetWidth","translateX","leave","LESSON","CONFIG","CLIENT","window","location","href","indexOf","API","FACEBOOK_APP_ID","assetTypeEnum","Unknown","Picture","IOS","navigator","userAgent","match","constant","controllerAs","resolve","Users","isLoggedOrGoTo","$httpProvider","defaults","withCredentials","directive","link","scope","attributes","onTap","e","addClass","removeClass","addListeners","on","removeListeners","off","restrict","delays","undefined","split","delay","forEach","d","i","parseInt","length","push","removeClasses","join","shift","a","$parse","$compile","$window","Utils","doTop","busy","onTop","$apply","sy","ey","undrag","doBottom","onBottom","lbottom2","offsetHeight","inner","lbottom","padding","dragging","wheeling","move","down","removeDragListeners","bounce","ltop","redraw","time","speed","Math","abs","cy","pause","min","max","innerStyle","transform","toFixed","set","showIndicatorFor","percent","iy","indicator","ix","round","rows","html","count","indicatorStyle","play","loop","aKey","requestAnimationFrame","cancelAnimationFrame","onDown","getTouch","addDragListeners","onMove","prev","onUp","up","_onWheel","dir","deltaY","wheelDelta","onWheel","ondragstart","$eval","attr","find","Style","append","contents","throttle","src","ngImg","image","Image","onload","$set","this","load","$watch","newValue","WebWorker","worker","doWork","onImageLoaded","url","ngImgWorker","replace","template","form","placeholder","formKey","formFocus","required","readonly","control","options","number","source","canCreate","flatten","queryable","onSelected","MAX_ITEMS","service","getPhrase","Clear","phrase","input","val","Current","active","onTyping","Enter","onSelect","Up","Down","Parse","value","index","toLowerCase","NameA","substr","NameB","NameC","Filter","c","Search","setPhrase","onKeyDown","keyCode","preventDefault","onKeyUp","call","getClosest","target","onBlur","Init","init","maxItems","Number","POSITIVE_INFINITY","onFocus","$parent","setItem","parsedItem","$item","$event","extend","$watchCollection","require","validateType","$parsers","unshift","$setValidity","String","toString","filter","$filter","legacyFilter","cost","currency","ratio","formatting","APP","inches","unit","units","IMPERIAL","feet","floor","meters","size","cm","pounds","oz","kg","weight","grams","precision","format","timezone","parseTime","parseHour","Guest","User","Supervisor","Admin","factory","UserRolesEnum","prototype","isAdmin","role","isUser","email","backgroundPicture","$q","FacebookService","onFacebookStatus","deferred","authResponse","status","reject","FB","defer","promise","getFacebookMe","facebook","api","fields","getPictureMe","width","height","getLoginStatus","login","logout","deletePermissions","fbAsyncInit","appId","cookie","xfbml","version","s","js","fjs","getElementsByTagName","getElementById","createElement","parentNode","insertBefore","document","LocalStorage","_currentUser","currentUser","getCurrentUser","isLogged","isAuthenticated","redirect","isAdminOrGoTo","signup","signInWithFacebook","auth","signout","detail","userRoute","Vector","make","b","sqrt","normalize","l","incidence","angle","atan2","distance","cross","difference","towards","friction","add","copy","t","touch","originalEvent","touches","changedTouches","pageX","pageY","getRelativeTouch","point","rect","getBoundingClientRect","left","top","el","selector","matchesFn","parent","some","fn","body","parentElement","func","wait","context","args","result","timeout","later","leading","getNow","apply","now","remaining","arguments","clearTimeout","trailing","lastTime","vendors","callback","currTime","Date","getTime","timeToCall","transformProperty","safariPropertyHack","div","style","every","prefix","props","hoverScale","currentScale","styles","cssText","transformOrigin","self","callbacks","Worker","onmessage","isWebWorkerSupported","transformResponse","h","eval","object","o","postMessage","parse","JSON","stringify","isSupported","$httpAsync","wrap","getDefaults","isSuccess","createMap","Object","create","isString","parseHeaders","headers","fillInParsed","parsed","j","line","lowercase","trim","isObject","p","headersGetter","headersObj","method","responseType","common","string","head","put","patch","getter","statusText"],"mappings":"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","file":"wwwroot/js/app.min.js","sourcesContent":["/*global angular,FB */\r\n\r\nvar app = angular.module('ullo', ['ngRoute', 'ngAnimate', 'ngMessages']);\r\n\r\napp.config(['$routeProvider', '$locationProvider', function ($routeProvider, $locationProvider) {\r\n\r\n\t$routeProvider.when('/', {                \r\n        controller: 'SignInCtrl',\r\n        templateUrl: 'templates/signin-test.html',\r\n        title: 'Sign In',        \r\n        \r\n    }).when('/signin', {                \r\n        controller: 'SignInCtrl',\r\n        templateUrl: 'templates/signin-test.html',\r\n        title: 'Sign In',\r\n        \r\n    }).when('/stream', {        \r\n        controller: 'TestCtrl',\r\n        templateUrl: 'templates/test.html',\r\n        title: 'TestCtrl',\r\n        isForward: true\r\n        \r\n    }).when('/dishes/:dishId', {        \r\n        controller: 'TestCtrl',\r\n        templateUrl: 'templates/test.html',\r\n        title: 'Dishes',\r\n        \r\n    }).when('/test', {                \r\n        controller: 'TestCtrl',\r\n        templateUrl: 'templates/temp.html',\r\n        title: 'HomePage',\r\n        \r\n    }).when('/404', {\r\n        controller: 'TestCtrl',\r\n        templateUrl: 'templates/test.html',\r\n        title: 'Errore 404',\r\n        isForward: true\r\n        \r\n    });\r\n    \r\n    $routeProvider.otherwise('/404');\r\n    \r\n    // HTML5 MODE url writing method (false: #/anchor/use, true: /html5/url/use)\r\n    $locationProvider.html5Mode(true);\r\n    \r\n}]);\r\n\r\napp.controller('SignInCtrl', ['$scope', '$timeout', '$http', '$location', function ($scope, $timeout, $http, $location) {\r\n\r\n    $scope.model = {};\r\n\r\n    $scope.input2Options = [{\r\n        name: 'Option1',\r\n        id:1   \r\n    }, {\r\n        name: 'Option2',\r\n        id:2   \r\n    }]\r\n    \r\n    $http.get('http://ulloapi.wslabs.it/api/stream/anonymous').then(function(response){\r\n        $scope.input2Options = response.data;\r\n    }, function(error) {\r\n        console.log('error', error);\r\n    });\r\n\r\n    $scope.signin = function () {\r\n        $scope.signinFormError = null;\r\n        $scope.signinFormBusy = true;\r\n        $scope.clicked = true;\r\n        $timeout(function() {\r\n            $http.post('http://ulloapi.wslabs.it/api/users/signin', $scope.model).then(function(success) {\r\n                console.log('signin', success);\r\n                $location.path('/stream');\r\n            }, function(error) {\r\n                console.log('error', error);\r\n                $scope.signinFormError = { message: error.message };\r\n            }).finally(function() {\r\n                $timeout(function() {\r\n                    $scope.signinFormBusy = false;\r\n                }, 3000);\r\n            });\r\n            $scope.clicked = false;\r\n        }, 1000);\r\n    };\r\n    \r\n}]);\r\n    \r\napp.controller('TestCtrl', ['$scope', '$timeout', '$http', function ($scope, $timeout, $http) {\r\n\r\n    $scope.model = {\r\n        label: 'Carica',\r\n    };\r\n        \r\n    setTimeout(function() {\r\n        $scope.model.label = 'Carica Stream';\r\n    }, 1000);\r\n\r\n    $scope.item = {\r\n        id: 117,\r\n        user: {\r\n            userName: 'Fabio Ottaviani',\r\n            facebookId: '10153341954226947',\r\n            route: 'fabio-ottaviani'\r\n        },\r\n        dish: {\r\n            price: 5,\r\n            isVeganFriendly: false,\r\n            yes: 1,\r\n            no: 0,\r\n            created: '2016-04-27T19:13:45.497',\r\n            vote: {\r\n                dishId: 19,\r\n                like: true,\r\n                created: '2016-04-27T19:14:00.497'\r\n            },\r\n            categories: [\r\n                {\r\n                    id: 2,\r\n                    name: 'Piadine',\r\n                    key: 'piadine'\r\n                }\r\n            ],\r\n            id: 19,\r\n            name: 'Pizza Margherita',\r\n            key: 'pizzaMargherita'\r\n        },\r\n        picture: {\r\n            guid: '8fe99743-4ed3-46de-ba13-2c1bd7a45ffe',\r\n            created: '2016-04-27T19:13:41.02',\r\n            id: 20,\r\n            name: '8fe99743-4ed3-46de-ba13-2c1bd7a45ffe',\r\n            route: '/Media/Files/8fe99743-4ed3-46de-ba13-2c1bd7a45ffe.jpg',\r\n            key: '8Fe997434Ed346DeBa132C1bd7a45ffe'\r\n        },\r\n        created: '2016-04-27T19:13:45.497'\r\n    };\r\n    \r\n    $scope.loadStream = function() {\r\n        $http.get('http://ulloapi.wslabs.it/api/stream/anonymous').then(function(response){\r\n            $scope.items = response.data;\r\n        }, function(error) {\r\n            console.log('error', error);\r\n        });\r\n    };\r\n\r\n}]);\r\n\r\n\n/*global angular,dynamics*/\r\n\r\napp.animation('.navigation', ['$rootScope', '$animate', function($rootScope, $animate) {\r\n    \r\n    var previousRoute = null;\r\n    var currentRoute = null;\r\n    var bezierOptions = {\r\n        type: dynamics.bezier,\r\n        points: [{ x: 0, y: 0, cp: [{ x: 0.509, y: 0.007 }] }, { x: 1, y: 1, cp: [{ x: 0.566, y: 0.997 }] }],\r\n        duration: 500,\r\n    }\r\n    \r\n    $rootScope.$on('$routeChangeSuccess', function(event, current, previous) {\r\n        previousRoute = previous.$$route;\r\n        currentRoute = current.$$route;\r\n    });\r\n    \r\n    function isFirstView() {\r\n        return !currentRoute;\r\n    }\r\n    function isBackward() {\r\n        return previousRoute && previousRoute.isForward;\r\n    }\r\n    return {\r\n        enter: function(element, done) {\r\n            if (isFirstView()) {\r\n                // FIRST ENTERING ANIMATION\r\n                dynamics.css(element[0], {\r\n                    translateY: 0,\r\n                    opacity: 0,\r\n                    scale: 1.2,\r\n                });\r\n                dynamics.animate(element[0], {\r\n                    translateY: 0,\r\n                    opacity: 1,\r\n                    scale: 1,\r\n                }, bezierOptions);\r\n            } else if (isBackward()) {\r\n                // BACKWARD ENTERING ANIMATION\r\n                var w = element[0].offsetWidth;\r\n                dynamics.css(element[0], {\r\n                    translateX: -w\r\n                });\r\n                dynamics.animate(element[0], {\r\n                    translateX: 0\r\n                }, bezierOptions);\r\n            } else {\r\n                // FORWARD ENTERING ANIMATION\r\n                var w = element[0].offsetWidth;\r\n                dynamics.css(element[0], {\r\n                    translateX: w\r\n                });\r\n                dynamics.animate(element[0], {\r\n                    translateX: 0\r\n                }, bezierOptions);\r\n            }\r\n            done();\r\n        },\r\n        leave: function(element, done) {\r\n            if (isBackward()) {\r\n                // BACKWARD EXITING ANIMATION\r\n                var w = element[0].offsetWidth;\r\n                dynamics.css(element[0], {\r\n                    translateX: 0\r\n                });\r\n                dynamics.animate(element[0], {\r\n                    translateX: w\r\n                }, bezierOptions);\r\n            } else {\r\n                // FORWARD EXITING ANIMATION\r\n                var w = element[0].offsetWidth;\r\n                dynamics.css(element[0], {\r\n                    translateX: 0\r\n                });\r\n                dynamics.animate(element[0], {\r\n                    translateX: -w\r\n                }, bezierOptions);\r\n            }\r\n            setTimeout(done, 1000);\r\n        }\r\n    }\r\n}]);\n/*global angular,FB */\r\n\r\nvar LESSON = true;\r\nvar CONFIG = {\r\n    CLIENT: window.location.href.indexOf('http://ulloclient.wslabs.it') === 0 ? 'http://ulloclient.wslabs.it' : 'http://dev.ullowebapp:8081',\r\n    API: (LESSON || window.location.href.indexOf('http://ulloclient.wslabs.it') === 0) ? 'http://ulloapi.wslabs.it' : 'https://localhost:44302',\r\n    FACEBOOK_APP_ID: window.location.href.indexOf('http://ulloclient.wslabs.it') === 0 ? '1054303094614120' : '1062564893787940',\r\n    assetTypeEnum: {\r\n        Unknown: 0,\r\n        Picture: 1,\r\n    },\r\n    IOS: (navigator.userAgent.match(/iPad|iPhone|iPod/g) ? true : false),\r\n};\r\n\r\napp.constant('APP', CONFIG);\r\n\r\napp.config(['$routeProvider', '$locationProvider', function ($routeProvider, $locationProvider) {\r\n\r\n\t// SECURE ROUTING\r\n    $routeProvider.when('/stream', {\r\n        title: 'Stream',\r\n        templateUrl: 'templates/stream.html',\r\n        controller: 'StreamCtrl',\r\n        controllerAs: 'streamCtrl',\r\n        resolve: {\r\n            user: ['Users', function(Users){\r\n                return Users.isLoggedOrGoTo('/splash');\r\n            }]\r\n        },\r\n\r\n    }).when('/dishes/:dishId', {\r\n        title: 'Dish',\r\n        templateUrl: 'templates/dish.html',\r\n        controller: 'DishCtrl',\r\n        controllerAs: 'dishCtrl',\r\n        resolve: {\r\n            user: ['Users', function(Users){\r\n                return Users.isLoggedOrGoTo('/splash');\r\n            }]\r\n        },\r\n        isForward: true,\r\n\r\n    }).when('/categories/:categoryId', {\r\n        title: 'Category',\r\n        templateUrl: 'templates/category.html',\r\n        controller: 'CategoryCtrl',\r\n        controllerAs: 'categoryCtrl',\r\n        resolve: {\r\n            user: ['Users', function(Users){\r\n                return Users.isLoggedOrGoTo('/splash');\r\n            }]\r\n        },\r\n        isForward: true,\r\n\r\n    }).when('/users/:userRoute', {\r\n        title: 'User',\r\n        templateUrl: 'templates/user.html',\r\n        controller: 'UserCtrl',\r\n        controllerAs: 'userCtrl',\r\n        resolve: {\r\n            user: ['Users', function(Users){\r\n                return Users.isLoggedOrGoTo('/splash');\r\n            }]\r\n        },\r\n        isForward: true,\r\n\r\n    }).when('/post', {\r\n        title: 'Add Post',\r\n        templateUrl: 'templates/post.html',\r\n        controller: 'PostCtrl',\r\n        controllerAs: 'postCtrl',\r\n        resolve: {\r\n            user: ['Users', function(Users){\r\n                return Users.isLoggedOrGoTo('/splash');\r\n            }]\r\n        },\r\n        isForward: true,\r\n\r\n    }).when('/settings', {\r\n        title: 'Settings',\r\n        templateUrl: 'templates/settings.html',\r\n        controller: 'SettingsCtrl',\r\n        controllerAs: 'settingsCtrl',\r\n        resolve: {\r\n            user: ['Users', function(Users){\r\n                return Users.isLoggedOrGoTo('/splash');\r\n            }]\r\n        },\r\n        isForward: true,\r\n\r\n\t// UNSECURE ROUTING\r\n    }).when('/splash', {\r\n        title: 'Splash',\r\n        templateUrl: 'templates/splash.html',\r\n        controller: 'SplashCtrl',\r\n        controllerAs: 'splashCtrl',\r\n\r\n    }).when('/signin', {\r\n        title: 'Sign In',\r\n        templateUrl: 'templates/signin.html',\r\n        controller: 'SigninCtrl',\r\n        controllerAs: 'signinCtrl',\r\n\r\n    }).when('/signup', {\r\n        title: 'Sign Up',\r\n        templateUrl: 'templates/signup.html',\r\n        controller: 'SignupCtrl',\r\n        controllerAs: 'signupCtrl',\r\n\r\n    }).when('/test', {\r\n        title: 'Test',\r\n        templateUrl: 'templates/dishes.html',\r\n        controller: 'TestCtrl',\r\n        controllerAs: 'testCtrl',\r\n\r\n    }).when('/404', {\r\n\r\n        title: 'Error 404',\r\n        templateUrl: '404.html',\r\n\r\n    });\r\n\r\n    $routeProvider.otherwise('/stream');\r\n\r\n    // HTML5 MODE url writing method (false: #/anchor/use, true: /html5/url/use)\r\n    $locationProvider.html5Mode(true);\r\n\r\n}]);\r\n\r\napp.config(['$httpProvider', function ($httpProvider) {\r\n    \r\n    $httpProvider.defaults.withCredentials = true;\r\n    \r\n}]);\r\n\n/*global angular,FB */\r\n\n/*global angular,FB,dynamics*/\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name onTap\r\n   * @kind function\r\n   * @requires $timeout\r\n   *\r\n   * @description\r\n   * When called, it add a class named 'tapped' on element and removes it after a timeout of 500 ms\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <button type=\"button\" on-tap>Tap me!</button>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n      </file>\r\n      <file name=\"style.css\">\r\n         .tapped {\r\n            background: red;\r\n         }\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('onTap', ['$timeout', function($timeout) {\r\n   return {\r\n      link: function(scope, element, attributes, model) {            \r\n         function onTap(e) {\r\n            console.log(attributes);\r\n            element.addClass('tapped');\r\n            $timeout(function() {\r\n               element.removeClass('tapped');\r\n            }, 500)\r\n         };\r\n         function addListeners() {\r\n            element.on('touchstart mousedown', onTap);\r\n         };\r\n         function removeListeners() {\r\n            element.off('touchstart mousedown', onTap);\r\n         };\r\n         scope.$on('$destroy', function() {\r\n            removeListeners();\r\n         });\r\n         addListeners();\r\n      }\r\n   }\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name animate\r\n   * @kind function\r\n   * @requires $timeout\r\n   *\r\n   * @description\r\n   * When called, it add a class named 'animated' on element\r\n   *\r\n   * @param {string} [animate=fadeIn] a comma separated animate.css class names\r\n   * @param {string} [delay=1] a comma separated durations list in milliseconds\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <div type=\"button\" animate=\"fadeInUp\" delay=\"1000\">\r\n            I'm an animated div.\r\n         </div>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('animate', ['$timeout', function($timeout) {\r\n   return {\r\n      restrict: 'A',\r\n      link: function(scope, element, attributes, model) {\r\n         element.addClass('animated');\r\n         var animate = ['fadeIn'], delays = ['1'];\r\n         if (attributes.animate !== undefined) {\r\n            animate = attributes.animate.split(',');\r\n         }\r\n         if (attributes.delay !== undefined) {\r\n            delays = attributes.delay.split(',');\r\n         }\r\n         angular.forEach(delays, function(d, i) {\r\n            delays[i] = parseInt(d);\r\n         });\r\n         while (delays.length < animate.length) {\r\n            delays.push(delays[delays.length - 1] + 50);\r\n         }\r\n         var removeClasses = animate.join(' ');\r\n         if (animate[0].indexOf('In') !== -1) {\r\n            element.addClass('invisible');\r\n            removeClasses += ' invisible';\r\n         }\r\n         while (animate.length) {\r\n            var d = delays.shift();\r\n            var a = animate.shift();\r\n            $timeout(function() {\r\n               element.removeClass(removeClasses);\r\n               element.addClass(a);\r\n               if (animate.length === 0 && a.indexOf('Out') !== -1) {\r\n                  $timeout(function() {\r\n                     element.addClass('invisible');\r\n                  }, 1000);\r\n               }\r\n            }, d);\r\n         }\r\n      }\r\n   }\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name scrollable\r\n   * @kind function\r\n   *\r\n   * @description\r\n   * Scrollable div 3d accellerated with touch functionality and callbacks for infinite scroll\r\n   *\r\n   * @param {promise} [on-top] optional callback function that execute when reaching top\r\n   * @param {promise} [on-bottom] optional callback function that execute when reaching bottom\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <div ng-controller=\"TestCtrl\">\r\n            <section class=\"scrollable content\" scrollable on-top=\"$root.doRefresh()\">\r\n               <div class=\"inner\">\r\n                  <ul>\r\n                     <li ng-repeat=\"item in [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]\">item <span ng-bind=\"item\"></span></li>\r\n                  </ul>\r\n               </div>\r\n            </section>\r\n         </div>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n         angular.controller('TestCtrl', ['$scope', '$q', function($scope, $q) {\r\n            $scope.doRefresh = function() {\r\n               var deferred = $q.defer();\r\n               if ($scope.busy) {\r\n                  deferred.reject();\r\n               } else {\r\n                  $scope.busy = true;\r\n                  $timeout(function() {\r\n                     $scope.busy = false;\r\n                     deferred.resolve();\r\n                  }, 500);\r\n               }\r\n               return deferred.promise;\r\n            };\r\n         }]);\r\n      </file>\r\n      <file name=\"style.css\">\r\n         .scrollable.content {\r\n            height: 200px!important;\r\n         }\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('scrollable', ['$parse', '$compile', '$window', '$timeout', 'Utils', function($parse, $compile, $window, $timeout, Utils) {\r\n   return {\r\n      restrict: 'A',\r\n      link: function(scope, element, attributes, model) {\r\n         $window.ondragstart = function() { return false; };\r\n         // CONSTS;\r\n         var padding = 150;\r\n         // FLAGS;\r\n         var dragging, wheeling, busy;\r\n         // MOUSE;\r\n         var down, move, prev, up;\r\n         // COORDS;\r\n         var sy = 0, ey = 0, cy = 0, ltop = 0, lbottom = 0, speed = 0, ix = 45, iy = 0;\r\n         // ANIMATION KEY;\r\n         var aKey;\r\n         var onTop, onBottom, showIndicatorFor;\r\n         if (attributes.onTop !== undefined) {\r\n            onTop = $parse(attributes.onTop, /* interceptorFn */ null, /* expensiveChecks */ true);\r\n         }\r\n         if (attributes.onBottom !== undefined) {\r\n            onBottom = $parse(attributes.onBottom, /* interceptorFn */ null, /* expensiveChecks */ true);\r\n         }\r\n         if (attributes.showIndicatorFor !== undefined) {\r\n            showIndicatorFor = scope.$eval(attributes.showIndicatorFor); // $parse(attributes.showIndicatorFor, /* interceptorFn */ null, /* expensiveChecks */ true);\r\n         }\r\n         // console.log('showIndicatorFor', showIndicatorFor);\r\n         // ELEMENTS & STYLESHEETS;\r\n         element.attr('unselectable', 'on').addClass('unselectable');\r\n         var inner = element.find('div');\r\n         var innerStyle = new Utils.Style();\r\n         var indicator = null, indicatorStyle;\r\n         if (showIndicatorFor) {\r\n            indicator = angular.element('<div class=\"indicator\"></div>');\r\n            indicatorStyle = new Utils.Style();\r\n            element.append(indicator);\r\n            $compile(indicator.contents())(scope);\r\n            indicatorStyle.transform('translate3d(' + ix.toFixed(2) + 'px,' + iy.toFixed(2) + 'px,0)');\r\n            indicatorStyle.set(indicator[0]);\r\n         }\r\n         function doTop() {\r\n            if (busy) {\r\n               return;\r\n            }\r\n            if (!onTop) {\r\n               return;\r\n            }\r\n            busy = true;\r\n            scope.$apply(onTop).then().finally(function() {\r\n               sy = ey = 0;\r\n               setTimeout(function() {\r\n                  undrag();\r\n                  busy = false;\r\n               }, 500);\r\n            });\r\n         }\r\n         function doBottom() {\r\n            if (busy) {\r\n               return;\r\n            }\r\n            if (!onBottom) {\r\n               return;\r\n            }\r\n            busy = true;\r\n            scope.$apply(onBottom).then().finally(function() {\r\n               var lbottom2 = element[0].offsetHeight - inner[0].offsetHeight;\r\n               if (lbottom2 > lbottom) {\r\n                  sy = ey = lbottom;\r\n               } else {\r\n                  sy = ey = lbottom + padding;\r\n               }\r\n               setTimeout(function() {\r\n                  undrag();\r\n                  busy = false;\r\n               }, 500);\r\n            });\r\n         }\r\n         function undrag() {\r\n            // console.log('undrag');\r\n            dragging = false;\r\n            wheeling = false;\r\n            move = null;\r\n            down = null;\r\n            removeDragListeners();\r\n         }\r\n         function bounce() {\r\n            ltop += padding;\r\n            lbottom -= padding;\r\n            if (ey > ltop) {\r\n               doTop();\r\n            } else if (ey < lbottom) {\r\n               doBottom();\r\n            }\r\n         }\r\n         function redraw(time) {\r\n            // if (!busy) {\r\n            ltop = 0;\r\n            lbottom = element[0].offsetHeight - inner[0].offsetHeight;\r\n            if (dragging) {\r\n               ey = sy + move.y - down.y;\r\n               bounce();\r\n            } else if (speed) {\r\n               ey += speed;\r\n               speed *= .75;\r\n               if (wheeling) {\r\n                  bounce();\r\n               }\r\n               if (Math.abs(speed) < 0.05) {\r\n                  speed = 0;\r\n                  ey = sy = cy;\r\n                  wheeling = false;\r\n                  pause();\r\n               }\r\n            }\r\n            // }\r\n            ey = Math.min(ltop, ey);\r\n            ey = Math.max(lbottom, ey);\r\n            cy += (ey - cy) / 4;\r\n            innerStyle.transform('translate3d(0,' + cy.toFixed(2) + 'px,0)');\r\n            innerStyle.set(inner[0]);\r\n            if (showIndicatorFor) {\r\n               if (dragging || wheeling || speed) {\r\n                  var percent = cy / (element[0].offsetHeight - inner[0].offsetHeight);\r\n                  percent = Math.max(0, Math.min(1, percent));\r\n                  iy = (element[0].offsetHeight - indicator[0].offsetHeight) * (percent);\r\n                  ix += (0 - ix) / 4;\r\n                  // var count = Math.round(inner[0].offsetHeight / 315);\r\n                  var i = Math.max(1, Math.round(percent * showIndicatorFor.rows.length));\r\n                  indicator.html(i + '/' + showIndicatorFor.count);\r\n                  // indicator.html((percent * 100).toFixed(2).toString());\r\n               } else {\r\n                  ix += (45 - ix) / 4;\r\n               }\r\n               indicatorStyle.transform('translate3d(' + ix.toFixed(2) + 'px,' + iy.toFixed(2) + 'px,0)');\r\n               indicatorStyle.set(indicator[0]);\r\n            }\r\n         }\r\n         function play() {\r\n            function loop(time) {\r\n               redraw(time);\r\n               aKey = window.requestAnimationFrame(loop, element);\r\n            }\r\n            if (!aKey) {\r\n               loop();\r\n            }\r\n         }\r\n         function pause() {\r\n            if (aKey) {\r\n               window.cancelAnimationFrame(aKey);\r\n               aKey = null;\r\n               // console.log('Animation.paused');\r\n            }\r\n         }\r\n         function onDown(e) {\r\n            if (!busy) {\r\n               sy = ey = cy;\r\n               speed = 0;\r\n               down = Utils.getTouch(e);\r\n               wheeling = false;\r\n               // console.log(down);\r\n               addDragListeners();\r\n               play();\r\n            }\r\n         }\r\n         function onMove(e) {\r\n            prev = move;\r\n            move = Utils.getTouch(e);\r\n            dragging = true;\r\n            // console.log(move);\r\n         }\r\n         function onUp(e) {\r\n            if (move && prev) {\r\n               speed += (move.y - prev.y) * 4;\r\n            }\r\n            sy = ey = cy;\r\n            dragging = false;\r\n            move = null;\r\n            down = null;\r\n            prev = null;\r\n            up = Utils.getTouch(e);\r\n            // console.log(up);\r\n            removeDragListeners();\r\n         }\r\n         function _onWheel(e) {\r\n            if (!busy) {\r\n               if (!e) e = event;\r\n               var dir = (((e.deltaY < 0 || e.wheelDelta > 0) || e.deltaY < 0) ? 1 : -1)\r\n               /*\r\n               var evt = window.event || e;\r\n               var delta = evt.detail ? evt.detail * -120 : evt.wheelDelta\r\n               speed += delta;\r\n               */\r\n               speed += dir * 5;\r\n               wheeling = true;\r\n               play();\r\n            }\r\n         }\r\n         var onWheel = Utils.throttle(_onWheel, 25);\r\n         function addListeners() {\r\n            element.on('touchstart mousedown', onDown);\r\n            element.on('wheel', onWheel);\r\n            // element.addEventListener('DOMMouseScroll',handleScroll,false); // for Firefox\r\n            // element.addEventListener('mousewheel',    handleScroll,false); // for everyone else\r\n         };\r\n         function removeListeners() {\r\n            element.off('touchstart mousedown', onDown);\r\n            element.off('wheel', onWheel);\r\n         };\r\n         function addDragListeners() {\r\n            angular.element($window).on('touchmove mousemove', onMove);\r\n            angular.element($window).on('touchend mouseup', onUp);\r\n         };\r\n         function removeDragListeners() {\r\n            angular.element($window).off('touchmove mousemove', onMove);\r\n            angular.element($window).off('touchend mouseup', onUp);\r\n         };\r\n         scope.$on('$destroy', function() {\r\n            removeListeners();\r\n         });\r\n         addListeners();\r\n      },\r\n   };\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name ngImg\r\n   * @kind function\r\n   *\r\n   * @description\r\n   * Whenever the image has loaded, a loaded class will be added to the image element\r\n   *\r\n   * @param {string} ng-img path to the image to load\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <img src=\"\" ng-img=\"'/img/nature-01.jpg'\"/>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n      </file>\r\n      <file name=\"style.css\">\r\n         [ng-img] {\r\n            max-width: 100%;\r\n            opacity: 0;\r\n            transition: opacity ease-in-out 250ms;\r\n         }\r\n         [ng-img].loaded {\r\n            opacity: 1;\r\n         }\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('ngImg', ['$parse', '$timeout', function($parse, $timeout) {\r\n   return {\r\n      restrict: 'A',\r\n      link: function(scope, element, attributes, model) {\r\n         var src = $parse(attributes.ngImg, /* interceptorFn */ null, /* expensiveChecks */ true);\r\n         var image = new Image();\r\n         image.onload = function() {\r\n            attributes.$set('src', this.src);\r\n            setTimeout(function() {\r\n               element.addClass('loaded');\r\n            }, 10);\r\n         }\r\n         image.load = function(src) {\r\n            element.removeClass('loaded');\r\n            this.src = src;\r\n         }\r\n         scope.$watch(src, function(newValue) {\r\n            if (!newValue) {\r\n               attributes.$set('src', null);\r\n            } else {\r\n               image.load(newValue);\r\n            }\r\n         });\r\n      }\r\n   };\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name ngImgWorker\r\n   * @kind function\r\n   *\r\n   * @description\r\n   * As ngImg but using webworker. Whenever the image has loaded, a loaded class will be added to the image element\r\n   *\r\n   * @param {string} ng-img path to the image to load\r\n   *\r\n   * @example\r\n\t<example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <img src=\"\" ng-img-worker=\"'/img/nature-02.jpg'\"/>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n      </file>\r\n      <file name=\"style.css\">\r\n         [ng-img] {\r\n            max-width: 100%;\r\n            opacity: 0;\r\n            transition: opacity ease-in-out 250ms;\r\n         }\r\n         [ng-img].loaded {\r\n            opacity: 1;\r\n         }\r\n      </file>\r\n\t</example>\r\n*/\r\napp.directive('ngImgWorker', ['$parse', 'WebWorker', function($parse, WebWorker) {\r\n   var worker = new WebWorker('/js/workers/loader.min.js');\r\n   return {\r\n      restrict: 'A',\r\n      link: function(scope, element, attributes, model) {\r\n         function doWork(src) {\r\n            element.removeClass('loaded');\r\n            function onImageLoaded(src) {\r\n               attributes.$set('src', src);\r\n               setTimeout(function() {\r\n                  element.addClass('loaded');\r\n               }, 100);\r\n            }\r\n            worker.post({ url: src }).then(function(data) {\r\n               onImageLoaded(data.url);\r\n            }, function(error) {\r\n               onImageLoaded(null);\r\n            });\r\n         }\r\n         var src = scope.$eval(attributes.ngImgWorker);\r\n         if (!src) {\r\n            attributes.$set('src', null);\r\n         } else {\r\n            doWork(src);\r\n         }\r\n      }\r\n   };\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name control\r\n   * @kind function\r\n   *\r\n   * @description\r\n   * Dinamic form control generator through templates with extended validation\r\n   *\r\n   * @param {string} model the target model of control\r\n   * @param {string} [control=text] the type of control, available types (text, password, email, number, checkbox, textarea, datetime-local, select, autocomplete)\r\n   * @param {string} [form=Form] the name of the form\r\n   * @param {string} [title=Untitled] the title of the control\r\n   * @param {string} [placeholder=title] the placeholder of the control\r\n   * @param {string} [source=null] datasource of select as array\r\n   * @param {string} [key=id] optional key for select option\r\n   * @param {string} [label=name] optional label for select option\r\n   * @param {string} [required=false] if the control is required\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <div class=\"container-fluid\">\r\n            <div class=\"row\">\r\n               <form name=\"myForm\">\r\n                  <div class=\"form-group col-xs-12\" form=\"myForm\" control=\"select\" title=\"category\" placeholder=\"select a category\" model=\"model.category\" source=\"[{name:'Main',id:1}, {name:'Second',id:2}]\" required=\"true\"></div>\r\n                  <div class=\"form-group col-xs-12\" form=\"myForm\" control=\"number\" title=\"dish price\" placeholder=\"type the price of the dish\" model=\"model.dish.price\" required=\"true\"></div>\r\n                  <div class=\"form-group col-xs-12\" form=\"myForm\" control=\"checkbox\" title=\"is vegan friendly\" placeholder=\"please check if the dish is vegan friendly\" model=\"model.dish.isVeganFriendly\"></div>\r\n               </form>\r\n            </div>\r\n         </div>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('control', [function() {\r\n   return {\r\n      restrict: 'A',\r\n      replace: true,\r\n      template: function(element, attributes) {\r\n         var form = attributes.form || 'Form';\r\n         var title = attributes.title || 'Untitled';\r\n         var placeholder = attributes.placeholder || title;\r\n         var name = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('');\r\n         var formKey = form + '.' + name;\r\n         var formFocus = ' ng-focus=\"' + formKey + '.hasFocus=true\" ng-blur=\"' + formKey + '.hasFocus=false\"';\r\n         var required = '';\r\n         var label = (attributes.label ? attributes.label : 'name');\r\n         var key = (attributes.key ? attributes.key : 'id');\r\n         var model = attributes.model;\r\n         if (attributes.required) {\r\n            required = '<span ng-messages=\"' + (attributes.readonly ? '' : '(' + form + '.$submitted || ' + formKey + '.$touched) && ') + form + '.' + name + '.$error\" role=\"alert\"><span ng-message=\"required\" class=\"label-error animated flash\"> &larr; required</span>';\r\n            switch (attributes.control) {\r\n               case 'password':\r\n                  required = required + '<span ng-message=\"minlength\" class=\"label-error animated flash\"> &larr; at least 6 chars</span>';\r\n                  break;\r\n               case 'email':\r\n                  required = required + '<span ng-message=\"email\" class=\"label-error animated flash\"> &larr; incorrect</span>';\r\n                  break;\r\n               case 'number':\r\n                  required = required + '<span ng-message=\"number\" class=\"label-error animated flash\"> &larr; enter a valid number</span>';\r\n                  break;\r\n            }\r\n            if (attributes.match !== undefined) {\r\n               required = required + '<span ng-message=\"match\" class=\"label-error animated flash\"> &larr; not matching</span>';\r\n            }\r\n            required = required + '</span>';\r\n         } else {\r\n            required = ' (optional)';\r\n         }\r\n         var template = '<div ' + (attributes.readonly ? ' class=\"readonly\" ' : '') + ' ng-class=\"{ focus: ' + formKey + '.hasFocus, success: ' + formKey + '.$valid, error: ' + formKey + '.$invalid && (form.$submitted || ' + formKey + '.$touched), empty: !' + formKey + '.$viewValue }\"><label for=\"' + name + '\" class=\"control-label\">' + title + required + '</label>';\r\n         switch (attributes.control) {\r\n            case 'checkbox':\r\n               template = '<div class=\"checkbox\">';\r\n               template += '<span class=\"checkbox-label\">' + title + required + '</span>';\r\n               template += '<span class=\"switch\"><input id=\"' + name + '\" name=\"' + name + '\" type=\"checkbox\" ng-model=\"' + model + '\" ' + (attributes.required ? 'required=\"true\"' : '') + ' class=\"toggle toggle-round-flat\"><label for=\"' + name + '\"></label></span>';\r\n               template += '</div>';\r\n               break;\r\n            case 'select':\r\n               var options = attributes.number\r\n                  ? 'item.' + key + ' as item.' + label + ' for item in ' + attributes.source\r\n                  : 'item.' + label + ' for item in ' + attributes.source + ' track by item.' + key;\r\n               template += '<select name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\" ng-options=\"' + options + '\" ' + (attributes.number ? 'convert-to-number' : '') + ' ' + (attributes.required ? 'required=\"true\"' : '') + '><option value=\"\" disabled selected hidden>' + placeholder + '</option></select>';\r\n               break;\r\n            case 'autocomplete':\r\n               var canCreate = (attributes.canCreate ? attributes.canCreate : false);\r\n               var flatten = (attributes.flatten ? attributes.flatten : false);\r\n               var queryable = (attributes.queryable ? attributes.queryable : false);\r\n               var onSelected = (attributes.onSelected ? ' on-selected=\"' + attributes.onSelected + '\"' : '');\r\n               template += '<input name=\"' + name + '\" ng-model=\"' + model + '\" type=\"hidden\" ' + (attributes.required ? 'required' : '') + '>';\r\n               template += '<div control-autocomplete=\"' + attributes.source + '\" model=\"' + model + '\" label=\"' + label + '\"  key=\"' + key + '\" can-create=\"' + canCreate + '\" flatten=\"' + flatten + '\" queryable=\"' + queryable + '\" placeholder=\"' + placeholder + '\" on-focus=\"' + formKey + '.hasFocus=true\" on-blur=\"' + formKey + '.hasFocus=false\"' + onSelected + '></div>';\r\n               break;\r\n            case 'textarea':\r\n               template += '<textarea name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" ' + (attributes.required ? 'required' : '') + ' rows=\"' + (attributes.rows ? attributes.rows : '1') + '\"' + formFocus + '></textarea>';\r\n               break;\r\n            case 'datetime-local':\r\n               placeholder == title ? placeholder = 'yyyy-MM-ddTHH:mm:ss' : null;\r\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"datetime-local\"' + (attributes.required ? ' required' : '') + (attributes.readonly ? ' readonly' : '') + formFocus + '>';\r\n               break;\r\n            case 'password':\r\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"password\" ng-minlength=\"6\" ' + (attributes.required ? 'required' : '') + formFocus + '>';\r\n               break;\r\n            case 'email':\r\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"email\" ' + (attributes.required ? 'required' : '') + formFocus + '>';\r\n               break;\r\n            case 'number':\r\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"text\"' + (attributes.required ? ' required' : '') + (attributes.readonly ? ' readonly' : '') + formFocus + ' validate-type=\"number\">'; // ' validator=\"{ number: isNumber }\">';\r\n               break;\r\n            case 'text':\r\n            default:\r\n               template += '<input name=\"' + name + '\" class=\"form-control\" ng-model=\"' + model + '\"' + (attributes.options ? ' ng-model-options=\"' + attributes.options + '\" ' : '') + ' placeholder=\"' + placeholder + '\" type=\"text\"' + (attributes.required ? ' required' : '') + (attributes.readonly ? ' readonly' : '') + formFocus + '>';\r\n               break;\r\n         }\r\n         return template + '</div>';\r\n      },\r\n      link: function(scope, element, attributes, model) {\r\n      },\r\n   };\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name controlAutocomplete\r\n   * @kind function\r\n   * @requires ngModel\r\n   *\r\n   * @description\r\n   * Custom control type with autocomplete functionality. (use the shortcut version with control directive)\r\n   *\r\n   * @param {service} controlAutocomplete the datasource service\r\n   * @param {model} model the target model of control\r\n   * @param {boolean} [canCreate=false] setted on true the control can add new entities\r\n   * @param {boolean} [flatten=false] set to true to flat the value to the model\r\n   * @param {boolean} [queryable=false] set to true if is a queryable service\r\n   * @param {string} [key=id] optional key for select option\r\n   * @param {string} [label=name] optional label for select option\r\n   *\r\n   * @example\r\n   <example module=\"examples\">\r\n      <file name=\"index.html\">\r\n         <div class=\"container-fluid\">\r\n            <div class=\"row\">\r\n               <form name=\"myForm\">\r\n                  <div class=\"form-group col-xs-12 empty focus\">\r\n                     <label for=\"dishname\" class=\"control-label\">dish name<span ng-messages=\"(myForm.$submitted || myForm.dishname.$touched) &amp;&amp; myForm.dishname.$error\" role=\"alert\" class=\"ng-inactive\"></span></label>\r\n                     <input name=\"dishname\" ng-model=\"model.name\" type=\"hidden\" required=\"\">\r\n                     <div control-autocomplete=\"dishesAutocomplete\" model=\"model.name\" label=\"name\" key=\"name\" can-create=\"true\" flatten=\"true\" queryable=\"false\" placeholder=\"type the name of the dish\" on-focus=\"myForm.dishname.hasFocus=true\" on-blur=\"myForm.dishname.hasFocus=false\" on-selected=\"onDishSelected($item)\" class=\"ng-isolate-scope\"></div>\r\n               </form>\r\n            </div>\r\n         </div>\r\n      </file>\r\n      <file name=\"script.js\">\r\n         angular.module('examples', ['wsUtils']);\r\n         angular.run(['$rootScope', '$q', function($rootScope, $q) {\r\n            $rootScope.dishesAutocomplete = ;\r\n            $rootScope.onDishSelected = function($item) {\r\n               alert($item);\r\n            };\r\n         }]);\r\n      </file>\r\n   </example>\r\n*/\r\napp.directive('controlAutocomplete', ['$parse', '$window', '$timeout', 'Utils', function($parse, $window, $timeout, Utils) {\r\n   var MAX_ITEMS = 5;\r\n   return {\r\n      restrict: 'A',\r\n      scope: {\r\n         service: '=controlAutocomplete',\r\n         canCreate: '=',\r\n         flatten: '=',\r\n         queryable: '=',\r\n         model: '=',\r\n         label: '@',\r\n         key: '@',\r\n      },\r\n      template: function(element, attributes) {\r\n         var template = '<div>';\r\n         template += '   <input class=\"form-control\" ng-model=\"phrase\" ng-model-options=\"{ debounce: 150 }\" placeholder=\"' + attributes.placeholder + '\" type=\"text\" ng-focus=\"onFocus()\">';\r\n         template += '   <ul class=\"form-autocomplete\" ng-show=\"items.length\">';\r\n         template += '       <li ng-repeat=\"item in items\" ng-class=\"{ active: active == $index }\" ng-click=\"onSelect(item)\">';\r\n         template += '           <span>{{item.NameA}}<span class=\"token\">{{item.NameB}}</span>{{item.NameC}}</span>';\r\n         template += '       </li>';\r\n         template += '   </ul>';\r\n         template += '</div>';\r\n         return template;\r\n      },\r\n      link: function(scope, element, attributes, model) {\r\n         var onSelected = $parse(attributes.onSelected);\r\n         var input = element.find('input');\r\n         var label = (scope.label ? scope.label : 'name');\r\n         var key = (scope.key ? scope.key : 'id');\r\n         function getPhrase() {\r\n            if (scope.model) {\r\n               return scope.flatten ? scope.model : scope.model[label];\r\n            } else {\r\n               return null;\r\n            }\r\n         }\r\n         scope.phrase = getPhrase();\r\n         scope.count = 0;\r\n         scope.items = [];\r\n         scope.active = -1;\r\n         scope.maxItems = scope.maxItems || Number.POSITIVE_INFINITY;\r\n         function Clear(phrase) {\r\n            scope.items.length = 0;\r\n            scope.count = 0;\r\n            scope.phrase = phrase || null;\r\n            input.val(scope.phrase);\r\n         }\r\n         function Current() {\r\n            var current = null;\r\n            if (scope.active != -1 && scope.items.length > scope.active) {\r\n               current = scope.items[scope.active];\r\n            }\r\n            return current;\r\n         }\r\n         scope.onFocus = function() {\r\n            if (attributes.onFocus !== undefined) {\r\n               scope.$parent.$eval(attributes.onFocus);\r\n            }\r\n            if (input.val() === getPhrase()) {\r\n               input.val(null);\r\n            }\r\n         };\r\n         scope.onBlur = function() {\r\n            if (attributes.onBlur !== undefined) {\r\n               scope.$parent.$eval(attributes.onBlur);\r\n            }\r\n            Clear(getPhrase());\r\n         };\r\n         scope.onSelect = function(item) {\r\n            if (scope.queryable) {\r\n               scope.service.setItem(item).then(function(parsedItem) {\r\n                  onSelected({ $item: parsedItem }, scope.$parent, { $event: {} });\r\n                  $timeout(function() {\r\n                     if (scope.flatten) {\r\n                        scope.model = parsedItem[key];\r\n                     } else {\r\n                        scope.model = scope.model || {};\r\n                        angular.extend(scope.model, parsedItem);\r\n                     }\r\n                     scope.onBlur();\r\n                  }, 1);\r\n               });\r\n            } else {\r\n               onSelected({ $item: item }, scope.$parent, { $event: {} });\r\n               if (scope.flatten) {\r\n                  scope.model = item[key];\r\n               } else {\r\n                  scope.model = scope.model || {};\r\n                  angular.extend(scope.model, item);\r\n               }\r\n               scope.onBlur();\r\n            }\r\n         };\r\n         function onTyping(phrase) {\r\n            if (scope.canCreate) {\r\n               if (scope.flatten) {\r\n                  if (key === label) {\r\n                     scope.model = phrase;\r\n                  }\r\n               } else {\r\n                  scope.model = {};\r\n                  scope.model[label] = phrase;\r\n               }\r\n            }\r\n         };\r\n         function Enter() {\r\n            var item = Current();\r\n            if (item) {\r\n               scope.onSelect(item);\r\n            }\r\n            scope.$apply();\r\n         }\r\n         function Up() {\r\n            scope.active--;\r\n            if (scope.active < 0) {\r\n               scope.active = scope.items.length - 1;\r\n            }\r\n            scope.$apply();\r\n         }\r\n         function Down() {\r\n            scope.active++;\r\n            if (scope.items.length == 0) {\r\n               scope.active = -1;\r\n            } else if (scope.active >= scope.items.length) {\r\n               scope.active = 0;\r\n            }\r\n            scope.$apply();\r\n         }\r\n         function Parse(data) {\r\n            scope.items = data.items;\r\n            scope.count = data.count;\r\n            angular.forEach(scope.items, function(value, index) {\r\n               var name = value[label];\r\n               var i = name.toLowerCase().indexOf(scope.phrase.toLowerCase());\r\n               value.NameA = name.substr(0, i);\r\n               value.NameB = name.substr(i, scope.phrase.length);\r\n               value.NameC = name.substr(i + scope.phrase.length, name.length - (i + scope.phrase.length));\r\n            });\r\n         }\r\n         function Filter(data) {\r\n            var c = 0, i = [];\r\n            if (scope.phrase.length > 1) {\r\n               angular.forEach(data.items, function(value, index) {\r\n                  var name = value[label];\r\n                  if (name.toLowerCase().indexOf(scope.phrase.toLowerCase()) !== -1) {\r\n                     if (i.length < MAX_ITEMS) {\r\n                        i.push(value);\r\n                     }\r\n                     c++;\r\n                  }\r\n               });\r\n            }\r\n            Parse({\r\n               count: c,\r\n               items: i\r\n            });\r\n         }\r\n         function Search() {\r\n            scope.phrase = input.val();\r\n            scope.active = -1;\r\n            onTyping(scope.phrase);\r\n            if (scope.queryable) {\r\n               scope.service.setPhrase(scope.phrase).then(function(success) {\r\n                  scope.items = success.items;\r\n                  scope.count = success.count;\r\n               }, function(error) {\r\n                  console.log('Search.queryable.error', scope.phrase, error);\r\n               }).finally(function() {\r\n\r\n               });\r\n            } else {\r\n               Filter({\r\n                  count: scope.service.length,\r\n                  items: scope.service\r\n               });\r\n               scope.$apply();\r\n            }\r\n         }\r\n         function onKeyDown(e) {\r\n            switch (e.keyCode) {\r\n               case 9: // Tab\r\n               case 13: // Enter\r\n                  Enter();\r\n                  if (scope.items.length) {\r\n                     e.preventDefault ? e.preventDefault() : null;\r\n                     return false;\r\n                  }\r\n                  break;\r\n               case 38: // Up\r\n                  Up();\r\n                  break;\r\n               case 40: // Down\r\n                  Down();\r\n                  break;\r\n            }\r\n         }\r\n         function onKeyUp(e) {\r\n            switch (e.keyCode) {\r\n               case 9: // Tab\r\n               case 13: // Enter\r\n                  break;\r\n               case 39: // Right\r\n                  break;\r\n               case 37: // Left\r\n                  break;\r\n               case 38: // Up\r\n                  break;\r\n               case 40: // Down\r\n                  break;\r\n               default: // Text\r\n                  Search.call(this);\r\n                  break;\r\n            }\r\n         }\r\n         function onUp(e) {\r\n            if (Utils.getClosest(e.target, '[control-autocomplete]') === null) {\r\n               scope.$apply(function() {\r\n                  scope.onBlur();\r\n               });\r\n            }\r\n            return true;\r\n         }\r\n         function addListeners() {\r\n            input.on('keydown', onKeyDown);\r\n            input.on('keyup', onKeyUp);\r\n            angular.element($window).on('mouseup touchend', onUp);\r\n         };\r\n         function removeListeners() {\r\n            input.off('keydown', onKeyDown);\r\n            input.off('keyup', onKeyUp);\r\n            angular.element($window).off('mouseup touchend', onUp);\r\n         };\r\n         scope.$on('$destroy', function() {\r\n            removeListeners();\r\n         });\r\n         var init = false;\r\n         function Init() {\r\n            if (!init) {\r\n               addListeners();\r\n               init = true;\r\n            }\r\n         }\r\n         scope.$watch('service', function(newValue) {\r\n            if (newValue && (newValue.length || scope.queryable)) {\r\n               Init();\r\n            }\r\n         });\r\n         scope.$watchCollection('model', function(newValue) {\r\n            if (newValue) {\r\n               if (scope.flatten && label === key) {\r\n                  scope.phrase = newValue;\r\n                  input.val(scope.phrase);\r\n               } else if (newValue[label]) {\r\n                  scope.phrase = newValue[label];\r\n                  input.val(scope.phrase);\r\n               }\r\n            }\r\n         });\r\n      },\r\n   };\r\n}]);\r\n\r\n/**\r\n   * @ngdoc directive\r\n   * @name validateType\r\n   * @kind function\r\n   * @requires ngModel\r\n   *\r\n   * @description\r\n   * Custom validation type for ngModel\r\n   *\r\n   * @param {string} [validateType=number] the type of custom validation\r\n   *\r\n   * @example\r\n\t<example module=\"examples\">\r\n\t\t<file name=\"index.html\">\r\n\t\t\t<form name=\"myForm\">\r\n\t\t\t\t<input name=\"myValue\" type=\"text\" ng-model=\"model\" validate-type=\"number\" />\r\n\t\t\t\t<span ng-messages=\"(myForm.$submitted || myForm.$touched) && myForm.myValue.$error\" role=\"alert\">\r\n\t\t\t\t\t<span ng-message=\"number\" class=\"label-error animated flash\"> &larr; enter a valid number</span>\r\n\t\t\t\t</span>\r\n\t\t\t</form>\r\n\t\t</file>\r\n\t\t<file name=\"script.js\">\r\n\t\t\tangular.module('examples', ['wsUtils']);\r\n\t\t</file>\r\n\t</example>\r\n*/\r\napp.directive('validateType', function() {\r\n   return {\r\n      require: 'ngModel',\r\n      link: function(scope, element, attributes, model) {\r\n         var type = attributes.validateType;\r\n         switch (type) {\r\n            case 'number':\r\n               model.$parsers.unshift(function(value) {\r\n                  model.$setValidity(type, String(value).indexOf(Number(value).toString()) !== -1);\r\n                  return value;\r\n               });\r\n               break;\r\n         }\r\n      }\r\n   };\r\n});\n\r\napp.filter('customCurrency', ['$filter', function ($filter) {\r\n    var legacyFilter = $filter('currency');\r\n    return function (cost, currency) {\r\n        return legacyFilter(cost * currency.ratio, currency.formatting);\r\n    }\r\n}]);\r\n\r\napp.filter('customSize', ['APP', function (APP) {\r\n    return function (inches) {\r\n        if (APP.unit === APP.units.IMPERIAL) {\r\n            var feet = Math.floor(inches / 12);\r\n            inches = inches % 12;\r\n            inches = Math.round(inches * 10) / 10;\r\n            return (feet ? feet + '\\' ' : '') + (inches + '\\'\\'');\r\n        } else {\r\n            var meters = Math.floor(inches * APP.size.ratio);\r\n            var cm = (inches * APP.size.ratio * 100) % 100;\r\n            cm = Math.round(cm * 10) / 10;\r\n            return (meters ? meters + 'm ' : '') + (cm + 'cm');\r\n        }\r\n    };\r\n}]);\r\n\r\napp.filter('customWeight', ['APP', function (APP) {\r\n    return function (pounds) {\r\n        if (APP.unit === APP.units.IMPERIAL) {\r\n            if (pounds < 1) {\r\n                var oz = pounds * 16;\r\n                oz = Math.round(oz * 10) / 10;\r\n                return (oz ? oz + 'oz ' : '');\r\n            } else {\r\n                pounds = Math.round(pounds * 100) / 100;\r\n                return (pounds ? pounds + 'lb ' : '');\r\n            }\r\n        } else {\r\n            var kg = Math.floor(pounds * APP.weight.ratio / 1000);\r\n            var grams = (pounds * APP.weight.ratio) % 1000;\r\n            grams = Math.round(grams * 10) / 10;\r\n            return (kg ? kg + 'kg ' : '') + (grams + 'g');\r\n        }\r\n    };\r\n}]);\r\n\r\napp.filter('customNumber', ['$filter', function ($filter) {\r\n    var filter = $filter('number');\r\n    return function (value, precision, unit) {\r\n        unit = unit || '';\r\n        return (value ? filter(value, precision) + unit : '-');\r\n    }\r\n}]);\r\n\r\napp.filter('customDate', ['$filter', function ($filter) {\r\n    var filter = $filter('date');\r\n    return function (value, format, timezone) {\r\n        return value ? filter(value, format, timezone) : '-';\r\n    }\r\n}]);\r\n\r\napp.filter('customTime', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        if (value) {\r\n            return Utils.parseTime(value);\r\n        } else {\r\n            return (placeholder ? placeholder : '-');\r\n        }\r\n    }\r\n}]);\r\n\r\napp.filter('customDigital', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        if (value) {\r\n            return Utils.parseHour(value);\r\n        } else {\r\n            return (placeholder ? placeholder : '-');\r\n        }\r\n    }\r\n}]);\r\n\r\napp.filter('customString', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        return value ? value : (placeholder ? placeholder : '-');\r\n    }\r\n}]);\r\n\r\napp.filter('customEnum', function () {\r\n    return function (val) {\r\n        val = val + 1;\r\n        return val < 10 ? '0' + val : val;\r\n    };\r\n});\r\n\n/*global angular,FB */\r\n\r\napp.value('UserRoles', [{\r\n    name: 'Guest', id: 1\r\n}, {\r\n    name: 'User', id: 2\r\n}, {\r\n    name: 'Supervisor', id: 3\r\n}, {\r\n    name: 'Admin', id: 4\r\n}]);\r\n\r\napp.value('UserRolesEnum', {\r\n    'Guest': 1,\r\n    'User': 2,\r\n    'Supervisor': 3,\r\n    'Admin': 4,\r\n});\r\n\r\napp.factory('User', ['UserRolesEnum', function (UserRolesEnum) {\r\n    function User(data) {\r\n        // Extend instance with data\r\n        data ? angular.extend(this, data) : null;\r\n    }\r\n    User.prototype = {\r\n        // If user instance is in role Administrator\r\n        isAdmin: function () {\r\n            return this.role === UserRolesEnum.Admin;\r\n        },\r\n        // If user parameters equals user instance\r\n        isUser: function (user) {\r\n            return this.email === user.email;\r\n        },\r\n        picture: function (size) {\r\n          size = size || 'sm';\r\n          var w;\r\n          switch(size) {\r\n              case 'sm':\r\n                w = 50;\r\n              break;\r\n              case 'md':\r\n                w = 300;\r\n              break;\r\n              default:\r\n          }\r\n          return this.facebookId ? 'https://graph.facebook.com/'+ this.facebookId +'/picture?width=' + w + '&height=' + w + '&type=square' : '/img/avatar-default.png';\r\n        },\r\n        backgroundPicture: function(size) {\r\n            return 'background-image: url(' + this.picture(size) + ');';\r\n        },\r\n    };\r\n    return User;\r\n}]);\n/*global angular,FB */\r\n\n/*global angular,FB */\r\n\r\napp.factory('FacebookService', ['$q', 'APP', function ($q, APP) {\r\n\r\n    function FacebookService() {\r\n\r\n    }\r\n\r\n    FacebookService.FB = function () {\r\n        var deferred = $q.defer();\r\n        if (window['FB'] !== undefined) {\r\n            deferred.resolve(window['FB']);\r\n        } else {\r\n            FacebookService.init().then(function (success) {\r\n                deferred.resolve(window['FB']);\r\n            }, function (error) {\r\n                deferred.reject(error);\r\n            })\r\n        }\r\n        return deferred.promise;\r\n    }\r\n\r\n    FacebookService.getFacebookMe = function () {\r\n        var deferred = $q.defer();\r\n\t\tFacebookService.FB().then(function (facebook) {\r\n            facebook.api('/me', { fields: 'id,name,first_name,last_name,email,gender,picture,cover,link' }, function (response) {\r\n                if (!response || response.error) {\r\n                    deferred.reject('Error occured');\r\n                } else {\r\n                    deferred.resolve(response);\r\n                }\r\n            });\r\n        });\r\n        return deferred.promise;\r\n    };\r\n\r\n    FacebookService.getPictureMe = function () {\r\n        var deferred = $q.defer();\r\n\t\tFacebookService.FB().then(function (facebook) {\r\n            facebook.api('/me/picture', { width: 300, height: 300, type: 'square' }, function (response) {\r\n                if (!response || response.error) {\r\n                    deferred.reject('Error occured');\r\n                } else {\r\n                    deferred.resolve(response);\r\n                }\r\n            });\r\n        });\r\n        return deferred.promise;\r\n    };\r\n\r\n    FacebookService.getLoginStatus = function () {\r\n        var deferred = $q.defer();\r\n\t\tFacebookService.FB().then(function (facebook) {\r\n            facebook.getLoginStatus(function (response) {\r\n                onFacebookStatus(response, deferred);\r\n            });\r\n        });\r\n        return deferred.promise;\r\n    };\r\n\r\n    FacebookService.login = function () {\r\n        var deferred = $q.defer();\r\n\t\tFacebookService.FB().then(function (facebook) {\r\n            facebook.login(function (response) {\r\n                onFacebookStatus(response, deferred);\r\n            }, {\r\n                scope: 'public_profile,email' // publish_stream,\r\n            });\r\n        });\r\n        return deferred.promise;\r\n    };\r\n\r\n    FacebookService.logout = function () {\r\n        var deferred = $q.defer();\r\n\t\tFacebookService.FB().then(function (facebook) {\r\n\t\t\tfacebook.logout(function (response) {\r\n\t\t\t\tdeferred.resolve(response);\r\n\t\t\t});\r\n        });\r\n        return deferred.promise;\r\n    };\r\n\r\n    FacebookService.deletePermissions = function () {\r\n        var deferred = $q.defer();\r\n\t\tFacebookService.FB().then(function (facebook) {\r\n\t\t\tfacebook.api('/me/permissions', 'delete', function (response) {\r\n\t\t\t\tdeferred.resolve(response);\r\n            });\r\n        });\r\n        return deferred.promise;\r\n    };\r\n\r\n    FacebookService.init = function () {\r\n        var deferred = $q.defer();\r\n        window.fbAsyncInit = function () {\r\n            FB.init({\r\n                appId: APP.FACEBOOK_APP_ID,\r\n                status: true,\r\n                cookie: true,\r\n                xfbml: true,\r\n                version: 'v2.5'\r\n            });\r\n            deferred.resolve(FB);\r\n        };\r\n        try {\r\n            (function (d, s, id) {\r\n                var js, fjs = d.getElementsByTagName(s)[0];\r\n                if (d.getElementById(id)) { return; }\r\n                js = d.createElement(s); js.id = id;\r\n                js.src = \"//connect.facebook.net/en_US/sdk.js\";\r\n                fjs.parentNode.insertBefore(js, fjs);\r\n            }(document, 'script', 'facebook-jssdk'));\r\n        } catch (e) {\r\n            deferred.reject(e);\r\n        }\r\n        return deferred.promise;\r\n    };\r\n\r\n    function onFacebookStatus(response, deferred) {\r\n        FacebookService.authResponse = null;\r\n        if (response.status === 'connected') {\r\n            FacebookService.authResponse = response.authResponse;\r\n            deferred.resolve(response);\r\n        } else if (response.status === 'not_authorized') {\r\n            deferred.reject(response);\r\n        } else {\r\n            deferred.reject(response);\r\n        }\r\n    };\r\n\r\n    return FacebookService;\r\n\r\n}]);\r\n\r\napp.factory('Users', ['$q', '$http', '$location', '$timeout', 'APP', 'LocalStorage', 'User', function ($q, $http, $location, $timeout, APP, LocalStorage, User) {\r\n\r\n    // PRIVATE VARIABLE FOR CURRENT USER\r\n    var _currentUser = null;\r\n\r\n    function Users() {\r\n    }\r\n\r\n    Users.prototype = {\r\n    };\r\n\r\n    // STATIC CLASS METHODS\r\n    Users.currentUser = function () {\r\n        return _currentUser;\r\n    };\r\n\r\n    Users.getCurrentUser = function () {\r\n        var deferred = $q.defer();\r\n        if (_currentUser) {\r\n            deferred.resolve(_currentUser);\r\n        } else {\r\n            $http.get(APP.API + '/api/users/current/').then(function success(response) {\r\n                if (response && response.data) {\r\n                    _currentUser = new User(response.data);\r\n                    deferred.resolve(_currentUser);\r\n                } else {\r\n                    deferred.resolve(null); // deferred.reject(null);\r\n                }\r\n            }, function error(response) {\r\n                deferred.reject(response);\r\n            });\r\n        }\r\n        return deferred.promise;\r\n    };\r\n\r\n    Users.isLogged = function () {\r\n        var deferred = $q.defer();\r\n        Users.getCurrentUser().then(function (user) {\r\n            // console.log('Users.isLogged.success', user);\r\n            user && user.isAuthenticated ? deferred.resolve(user) : deferred.reject();\r\n        }, function error(response) {\r\n            // console.log('Users.isLogged.error', data);\r\n            deferred.reject(response);\r\n        })\r\n        return deferred.promise;\r\n    };\r\n\r\n    Users.isAdmin = function () {\r\n        var deferred = $q.defer();\r\n        Users.getCurrentUser().then(function (user) {\r\n            user && user.isAuthenticated && user.isAdmin ? deferred.resolve(user) : deferred.reject();\r\n        }, function error(response) {\r\n            deferred.reject(response);\r\n        })\r\n        return deferred.promise;\r\n    };\r\n\r\n    Users.isLoggedOrGoTo = function(redirect) {\r\n        var deferred = $q.defer();\r\n        Users.getCurrentUser().then(function (user) {\r\n            // console.log('Users.isLogged.success', user);\r\n            if (user && user.isAuthenticated) {\r\n                deferred.resolve(user);\r\n            } else {\r\n                deferred.reject();\r\n                $location.path(redirect);\r\n            }\r\n        }, function error(response) {\r\n            // console.log('Users.isLogged.error', data);\r\n            deferred.reject(response);\r\n            $location.path(redirect);\r\n        })\r\n        return deferred.promise;\r\n    };\r\n\r\n    Users.isAdminOrGoTo = function(redirect) {\r\n        var deferred = $q.defer();\r\n        Users.getCurrentUser().then(function (user) {\r\n            // console.log('Users.isLogged.success', user);\r\n            if (user && user.isAuthenticated && user.isAdmin) {\r\n                deferred.resolve(user);\r\n            } else {\r\n                deferred.reject();\r\n                $location.path(redirect);\r\n            }\r\n        }, function error(response) {\r\n            // console.log('Users.isLogged.error', data);\r\n            deferred.reject(response);\r\n            $location.path(redirect);\r\n        })\r\n        return deferred.promise;\r\n    },\r\n\r\n    /** LOGIN METHODS **/\r\n    Users.signup = function (model) {\r\n        var deferred = $q.defer();\r\n        $http.post(APP.API + '/api/users/signup/', model).then(function success(response) {\r\n            _currentUser = new User(response.data);\r\n            deferred.resolve(_currentUser);\r\n        }, function error(response) {\r\n            deferred.reject(response);\r\n        });\r\n        return deferred.promise;\r\n    };\r\n\r\n    Users.signin = function (model) {\r\n        var deferred = $q.defer();\r\n        $http.post(APP.API + '/api/users/signin/', model).then(function success(response) {\r\n            _currentUser = new User(response.data);\r\n            deferred.resolve(_currentUser);\r\n        }, function error(response) {\r\n            deferred.reject(response);\r\n        });\r\n        return deferred.promise;\r\n    };\r\n\r\n    Users.signInWithFacebook = function (auth) {\r\n        var deferred = $q.defer();\r\n        $http.post(APP.API + '/api/users/signinwithfacebook/', auth).then(function success(response) {\r\n            _currentUser = new User(response.data);\r\n            deferred.resolve(_currentUser);\r\n        }, function error(response) {\r\n            deferred.reject(response);\r\n        });\r\n        return deferred.promise;\r\n    };\r\n\r\n    Users.signout = function () {\r\n        var deferred = $q.defer();\r\n        $http.get(APP.API + '/api/users/signout/').then(function success(response) {\r\n            _currentUser = null;\r\n            deferred.resolve(response.data);\r\n        }, function error(response) {\r\n            deferred.reject(response);\r\n        });\r\n        return deferred.promise;\r\n    };\r\n\r\n    Users.detail = function (userRoute) {\r\n        var deferred = $q.defer();\r\n        $http.get(APP.API + '/api/users/route/' + userRoute).then(function success(response) {\r\n            deferred.resolve(new User(response.data));\r\n        }, function error(response) {\r\n            deferred.reject(response);\r\n        });\r\n        return deferred.promise;\r\n    };\r\n\r\n    return Users;\r\n}]);\r\n\r\napp.factory('Vector', function() {\r\n\tfunction Vector(x, y) {\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n    }\r\n    Vector.make = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.size = function (a) {\r\n        return Math.sqrt(a.x * a.x + a.y * a.y);\r\n    };\r\n    Vector.normalize = function (a) {\r\n        var l = Vector.size(a);\r\n        a.x /= l;\r\n        a.y /= l;\r\n        return a;\r\n    };\r\n    Vector.incidence = function (a, b) {\r\n        var angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\r\n        // if (angle < 0) angle += 2 * Math.PI;\r\n        // angle = Math.min(angle, (Math.PI * 2 - angle));\r\n        return angle;\r\n    };\r\n    Vector.distance = function (a, b) {\r\n        return Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\r\n    };\r\n    Vector.cross = function (a, b) {\r\n        return (a.x * b.y) - (a.y * b.x);\r\n    };\r\n    Vector.difference = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.prototype = {\r\n        size: function () {\r\n            return Vector.size(this);\r\n        },\r\n        normalize: function () {\r\n            return Vector.normalize(this);\r\n        },\r\n        incidence: function (b) {\r\n            return Vector.incidence(this, b);\r\n        },\r\n        cross: function (b) {\r\n            return Vector.cross(this, b);\r\n        },\r\n        towards: function (b, friction) {\r\n            friction = friction || 0.125;\r\n            this.x += (b.x - this.x) * friction;\r\n            this.y += (b.y - this.y) * friction;\r\n            return this;\r\n        },\r\n        add: function (b) {\r\n            this.x += b.x;\r\n            this.y += b.y;\r\n            return this;\r\n        },\r\n        friction: function (b) {\r\n            this.x *= b;\r\n            this.y *= b;\r\n            return this;\r\n        },\r\n        copy: function (b) {\r\n            return new Vector(this.x, this.y);\r\n        },\r\n        toString: function () {\r\n            return '{' + this.x + ',' + this.y + '}';\r\n        },\r\n    };\r\n    return Vector;\r\n});\r\n\r\napp.factory('Utils', ['Vector', function (Vector) {\r\n    (function () {\r\n        var lastTime = 0;\r\n        var vendors = ['ms', 'moz', 'webkit', 'o'];\r\n        for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n            window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\r\n            window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame']\r\n                                       || window[vendors[x] + 'CancelRequestAnimationFrame'];\r\n        }\r\n        if (!window.requestAnimationFrame) {\r\n            window.requestAnimationFrame = function (callback, element) {\r\n                var currTime = new Date().getTime();\r\n                var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n                var id = window.setTimeout(function () { callback(currTime + timeToCall); }, timeToCall);\r\n                lastTime = currTime + timeToCall;\r\n                return id;\r\n            };\r\n        }\r\n        if (!window.cancelAnimationFrame) {\r\n            window.cancelAnimationFrame = function (id) {\r\n                clearTimeout(id);\r\n            };\r\n        }\r\n    }());\r\n\r\n    var transformProperty = function detectTransformProperty() {\r\n        var transformProperty = 'transform',\r\n            safariPropertyHack = 'webkitTransform';\r\n\t\tvar div = document.createElement(\"DIV\");\r\n        if (typeof div.style[transformProperty] !== 'undefined') {\r\n            ['webkit', 'moz', 'o', 'ms'].every(function(prefix) {\r\n                var e = '-' + prefix + '-transform';\r\n                if (typeof div.style[e] !== 'undefined') {\r\n                    transformProperty = e;\r\n                    return false;\r\n                }\r\n                return true;\r\n            });\r\n        } else if (typeof div.style[safariPropertyHack] !== 'undefined') {\r\n            transformProperty = '-webkit-transform';\r\n        } else {\r\n            transformProperty = undefined;\r\n        }\r\n        return transformProperty;\r\n    } ();\r\n\r\n    var _isTouch;\r\n    function isTouch() {\r\n        if (!_isTouch) {\r\n            _isTouch = {\r\n                value: ('ontouchstart' in window || 'onmsgesturechange' in window)\r\n            }\r\n        }\r\n        // console.log(_isTouch);\r\n        return _isTouch.value;\r\n    }\r\n\r\n    function getTouch(e, previous) {\r\n        var t = new Vector();\r\n        if (e.type == 'touchstart' || e.type == 'touchmove' || e.type == 'touchend' || e.type == 'touchcancel') {\r\n            var touch = null;\r\n            var event = e.originalEvent ? e.originalEvent : e;\r\n            var touches = event.touches.length ? event.touches : event.changedTouches;\r\n            if (touches && touches.length) {\r\n                touch = touches[0];\r\n            }\r\n            if (touch) {\r\n                t.x = touch.pageX;\r\n                t.y = touch.pageY;\r\n            }\r\n        } else if (e.type == 'click' || e.type == 'mousedown' || e.type == 'mouseup' || e.type == 'mousemove' || e.type == 'mouseover' || e.type == 'mouseout' || e.type == 'mouseenter' || e.type == 'mouseleave') {\r\n            t.x = e.pageX;\r\n            t.y = e.pageY;\r\n        }\r\n        if (previous) {\r\n            t.s = Vector.difference(previous, t);\r\n        }\r\n        t.type = e.type;\r\n        return t;\r\n    }\r\n\r\n    function getRelativeTouch(element, point) {\r\n        var rect = element[0].getBoundingClientRect();\r\n        var e = new Vector(rect.left,  rect.top);\r\n        return Vector.difference(e, point);\r\n    }\r\n\r\n    function getClosest(el, selector) {\r\n        var matchesFn, parent;\r\n        ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\r\n            if (typeof document.body[fn] == 'function') {\r\n                matchesFn = fn;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        while (el !== null) {\r\n            parent = el.parentElement;\r\n            if (parent !== null && parent[matchesFn](selector)) {\r\n                return parent;\r\n            }\r\n            el = parent;\r\n        }\r\n        return null;\r\n    }\r\n\r\n\r\n    var getNow = Date.now || function() {\r\n        return new Date().getTime();\r\n    };\r\n\r\n    function throttle(func, wait, options) {\r\n        // Returns a function, that, when invoked, will only be triggered at most once\r\n        // during a given window of time. Normally, the throttled function will run\r\n        // as much as it can, without ever going more than once per `wait` duration;\r\n        // but if you'd like to disable the execution on the leading edge, pass\r\n        // `{leading: false}`. To disable execution on the trailing edge, ditto.\r\n        var context, args, result;\r\n        var timeout = null;\r\n        var previous = 0;\r\n        if (!options) options = {};\r\n        var later = function () {\r\n            previous = options.leading === false ? 0 : getNow();\r\n            timeout = null;\r\n            result = func.apply(context, args);\r\n            if (!timeout) context = args = null;\r\n        };\r\n        return function () {\r\n            var now = getNow();\r\n            if (!previous && options.leading === false) previous = now;\r\n            var remaining = wait - (now - previous);\r\n            context = this;\r\n            args = arguments;\r\n            if (remaining <= 0 || remaining > wait) {\r\n                if (timeout) {\r\n                    clearTimeout(timeout);\r\n                    timeout = null;\r\n                }\r\n                previous = now;\r\n                result = func.apply(context, args);\r\n                if (!timeout) context = args = null;\r\n            } else if (!timeout && options.trailing !== false) {\r\n                timeout = setTimeout(later, remaining);\r\n            }\r\n            return result;\r\n        };\r\n    }\r\n\r\n    var Style = function() {\r\n        function Style() {\r\n            this.props = {\r\n                scale: 1,\r\n                hoverScale: 1,\r\n                currentScale: 1,\r\n            }\r\n        }\r\n        Style.prototype = {\r\n            set: function (element) {\r\n                var styles = [];\r\n                angular.forEach(this, function (value, key) {\r\n                    if (key !== 'props')\r\n                        styles.push(key + ':' + value);\r\n                });\r\n                element.style.cssText = styles.join(';') + ';';\r\n            },\r\n            transform: function (transform) {\r\n                this[Utils.transformProperty] = transform;\r\n            },\r\n            transformOrigin: function (x, y) {\r\n                this[Utils.transformProperty + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\r\n                this[Utils.transformProperty + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\r\n            },\r\n        };\r\n        return Style;\r\n    }();\r\n\r\n    function Utils() {\r\n    }\r\n\r\n\tUtils.transformProperty = transformProperty;\r\n    Utils.getTouch = getTouch;\r\n    Utils.getRelativeTouch = getRelativeTouch;\r\n    Utils.getClosest = getClosest;\r\n    Utils.throttle = throttle;\r\n    Utils.Style = Style;\r\n\r\n    return Utils;\r\n}]);\r\n\n/*global angular*/\r\n\r\napp.factory('WebWorker', ['$q', '$http', function ($q, $http) {\r\n    var isWebWorkerSupported = (typeof (Worker) !== \"undefined\");\r\n    if (!isWebWorkerSupported) {\r\n        window.Worker = function () {\r\n            function Worker(src) {\r\n                var self = this;\r\n                $http.get(src, { transformResponse: function (d, h) { return d } }).then(function success(response) {\r\n                    try {\r\n                        eval('self.o = function(){ function postMessage(e) { self.onmessage({data:e}); }\\n ' + response.data + ' };');\r\n                        self.object = new self.o();\r\n                        self.object.postMessage = function (e) {\r\n                            self.onmessage({data:e});\r\n                        }\r\n                    } catch(e) {\r\n                        console.log(\"Worker error \", e);\r\n                    }\r\n                }, function error(response) {\r\n                    console.log(\"Worker not found\");\r\n                });\r\n            }\r\n            Worker.prototype = {\r\n                onmessage: function (e) {\r\n                    console.log('Worker not implemented');\r\n                },\r\n                postMessage: function (e) {\r\n                    this.object.onmessage({ data: e });\r\n                }\r\n            }\r\n            return Worker;\r\n        } ();\r\n    }\r\n    function WebWorker(src) {\r\n        var self = this;\r\n        this.callbacks = {};\r\n        this.id = 0;\r\n        this.worker = new Worker(src);\r\n        this.worker.onmessage = function (e) {\r\n            self.onmessage(e);\r\n        };\r\n    }\r\n    WebWorker.prototype = {\r\n        parse: function (e) {\r\n            return JSON.parse(e.data);\r\n        },\r\n        stringify: function (data) {\r\n            return JSON.stringify(data);\r\n        },\r\n        onmessage: function (e) {\r\n            var data = this.parse(e);\r\n            var deferred = this.callbacks[data.id];\r\n            if (data.status !== -1) {\r\n                deferred.resolve(data);\r\n            } else {\r\n                deferred.reject(data);\r\n            }\r\n            delete this.callbacks[data.id];\r\n        },\r\n        post: function (data) {\r\n            var deferred = $q.defer();\r\n            data.id = this.id;\r\n            this.callbacks[this.id.toString()] = deferred;\r\n            this.id++;\r\n            this.worker.postMessage(this.stringify(data));\r\n            return deferred.promise;\r\n        },\r\n    };\r\n    WebWorker.isSupported = isWebWorkerSupported;\r\n    return WebWorker;\r\n}]);\r\n\r\napp.factory('$httpAsync', ['$q', '$http', function ($q, $http) {\r\n    var isWebWorkerSupported = (typeof (Worker) !== \"undefined\");\r\n    if (!isWebWorkerSupported) {\r\n        return $http;\r\n    }\r\n    var worker = new Worker('/js/workers/http.min.js');\r\n    var callbacks = {};\r\n    var id = 0;\r\n    var lowercase = function (string) { return isString(string) ? string.toLowerCase() : string; };\r\n    var trim = function (value) {\r\n        return isString(value) ? value.trim() : value;\r\n    };\r\n    function $httpAsync(options) {\r\n        var deferred = $q.defer();\r\n        var wrap = getDefaults(options);\r\n        wrap.id = id.toString();\r\n        console.log('wrap', wrap);\r\n        callbacks[wrap.id] = deferred;\r\n        id++;\r\n        worker.postMessage($httpAsync.stringify(wrap));\r\n        return deferred.promise;\r\n    }\r\n    $httpAsync.get = function (url, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'GET',\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.delete = function (url, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'DELETE',\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.head = function (url, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'HEAD',\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.post = function (url, data, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'POST',\r\n            data: data,\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.put = function (url, data, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'PUT',\r\n            data: data,\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.patch = function (url, data, config) {\r\n        return $httpAsync(angular.extend({}, config || {}, {\r\n            method: 'PATCH',\r\n            data: data,\r\n            url: url\r\n        }));\r\n    };\r\n    $httpAsync.parse = function (e) {\r\n        return JSON.parse(e.data);\r\n    };\r\n    $httpAsync.stringify = function (data) {\r\n        return JSON.stringify(data);\r\n    };\r\n    $httpAsync.isSupported = isWebWorkerSupported;\r\n    worker.onmessage = function (e) {\r\n        var wrap = $httpAsync.parse(e);\r\n        console.log('onmessage', wrap);\r\n        var deferred = callbacks[wrap.id];\r\n        var status = wrap.status >= -1 ? wrap.status : 0;\r\n        var getter = headersGetter(wrap.response.headers);\r\n        (isSuccess(status) ? deferred.resolve : deferred.reject)({\r\n            data: wrap.response.data, // !!!! JSON.parse(wrap.response.data),\r\n            headers: getter,\r\n            status: wrap.response.status,\r\n            statusText: wrap.response.statusText,\r\n            config: wrap.config,\r\n        });\r\n        delete callbacks[wrap.id];\r\n    }\r\n    return $httpAsync;\r\n    function isSuccess(status) {\r\n        return 200 <= status && status < 300;\r\n    }\r\n    function createMap() {\r\n        return Object.create(null);\r\n    }\r\n    function isString(value) { return typeof value === 'string'; }\r\n    function parseHeaders(headers) {\r\n        var parsed = createMap(), i;\r\n        function fillInParsed(key, val) {\r\n            if (key) {\r\n                parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\r\n            }\r\n        }\r\n        if (isString(headers)) {\r\n            var a = headers.split('\\n');\r\n            for (var j = 0; j < a.length; j++) {\r\n                var line = a[j];\r\n                i = line.indexOf(':');\r\n                fillInParsed(lowercase(trim(line.substr(0, i))), trim(line.substr(i + 1)));\r\n            }\r\n        } else if (isObject(headers)) {\r\n            for (var p in headers) {\r\n                fillInParsed(lowercase(p), trim(headers[p]));\r\n            }\r\n        }\r\n        return parsed;\r\n    }\r\n    function headersGetter(headers) {\r\n        var headersObj;\r\n        return function (name) {\r\n            if (!headersObj) headersObj = parseHeaders(headers);\r\n            if (name) {\r\n                var value = headersObj[lowercase(name)];\r\n                if (value === void 0) {\r\n                    value = null;\r\n                }\r\n                return value;\r\n            }\r\n            return headersObj;\r\n        };\r\n    }\r\n    function getDefaults(options) {\r\n        var defaults = {\r\n            method: 'GET',\r\n            withCredentials: false,\r\n            responseType: 'json',\r\n            headers: {},\r\n            config: {}\r\n        }\r\n        defaults.withCredentials = $http.defaults.withCredentials;\r\n        angular.extend(defaults.headers, $http.defaults.headers.common);\r\n        var method = (options.method || defaults.method).toLowerCase();\r\n        if ($http.defaults.headers[method]) {\r\n            angular.extend(defaults.headers, $http.defaults.headers[method]);\r\n        }\r\n        console.log('defaults', $http.defaults);\r\n        // defaults = angular.extend(defaults, $http.defaults);\r\n        /*\r\n    method{string}:                     HTTP method (e.g. 'GET', 'POST', etc)\r\n    url:{string}:                       Absolute or relative URL of the resource that is being requested.\r\n    params:{Object.<string|Object>}:    Map of strings or objects which will be serialized with the paramSerializer and appended as GET parameters.\r\n\r\n    data:{string|Object}:               Data to be sent as the request message data.\r\n    headers:{Object}:                   Map of strings or functions which return strings representing HTTP headers to send to the server. If the return value of a function is null, the header will not be sent. Functions accept a config object as an argument.\r\n\r\n    xsrfHeaderName:{string}:            Name of HTTP header to populate with the XSRF token.\r\n    xsrfCookieName:{string}:            Name of cookie containing the XSRF token.\r\n    transformRequest:{function(data, headersGetter)|Array.<function(data, headersGetter)>}:         transform function or an array of such functions. The transform function takes the http request body and headers and returns its transformed (typically serialized) version. See Overriding the Default Transformations\r\n\r\n    transformResponse:{function(data, headersGetter, status)|Array.<function(data, headersGetter, status)>}:    transform function or an array of such functions. The transform function takes the http response body, headers and status and returns its transformed (typically deserialized) version. See Overriding the Default TransformationjqLiks\r\n\r\n    paramSerializer:{string|function(Object<string,string>):string}:        A function used to prepare the string representation of request parameters (specified as an object). If specified as string, it is interpreted as function registered with the $injector, which means you can create your own serializer by registering it as a service. The default serializer is the $httpParamSerializer; alternatively, you can use the $httpParamSerializerJQLike\r\n\r\n    cache:{boolean|Cache}:              If true, a default $http cache will be used to cache the GET request, otherwise if a cache instance built with $cacheFactory, this cache will be used for caching.\r\n\r\n    timeout:{number|Promise}:           timeout in milliseconds, or promise that should abort the request when resolved.\r\n    withCredentials:{boolean}:          whether to set the withCredentials flag on the XHR object. See requests with credentials for more information.\r\n\r\n    responseType:{string}:              see XMLHttpRequest.responseType.\r\n        */\r\n        options ? options = angular.extend(defaults, options) : defaults;\r\n        return options;\r\n    }\r\n}]);\r\n"],"sourceRoot":"/source/"}